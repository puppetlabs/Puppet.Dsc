# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [1.0.0] - 2021-07-28

### Added

- Concept documentation for how Puppet invokes Puppetized DSC Resources in the `about_Puppetized_module_invocation` about help topic ([#74](https://github.com/puppetlabs/Puppet.Dsc/issues/74))
- `Export-PuppetModule` function to build a Puppetized PowerShell module into a packaged Puppet module ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))
- `Get-ForgeModuleInfo` function for retrieving releases and PowerShell metadata about Puppetized PowerShell modules on the forge ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))
- `Get-PowerShellDscModule` function for discovering Puppetizable PowerShell modules in a PowerShell repository ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))
- `Update-ForgeDscModule` function for rebuilding and publishing (with incremented Puppet build version) Puppetized DSC modules to the Forge ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))
- `Publish-NewDscModuleVersion` function for Puppetizing and publishing versions of PowerShell modules with DSC Resources which are not yet on the Forge in a specified namespace ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))

### Changed

- `Publish-PuppetModule` function to include the new `ExportFolder`, `PackagedModulePath`, and `Force` parameters, as well as refactor the function to use `Export-PuppetModule` and clean up the experience simultaneously building and publishing a Puppet module. Finally, the `ForgeToken` parameter now defaults to the `FORGE_TOKEN` environment variable if it is not passed directly ([#68](https://github.com/puppetlabs/ruby-pwsh/issues/68))

### Fixed

- Ensure that PowerShell module's missing the `ProjectURI` metadata key are still Puppetizable; they are valid modules on the PowerShell Gallery, so default the 'file an issue' link to the module's gallery link if the `ProjectUri` is missing ([#186](https://github.com/puppetlabs/ruby-pwsh/issues/186))

## [0.7.0] - 2021-07-02

### Added

- Ability to invoke class-based resources by adding the `dscmeta_resource_implementation` key in the generated types; functionality requires [puppetlabs-pwshlib](https://forge.puppet.com/modules/puppetlabs/pwshlib) `0.10.0` or higher ([#172](https://github.com/puppetlabs/ruby-pwsh/issues/172))

### Fixed

- Ensure Puppet type definition for nested cim instances declares the CIM Instance type as a single-value enum to prevent runtime errors when parsing them ([#180](https://github.com/puppetlabs/Puppet.Dsc/issues/180))

## [0.6.0] - 2021-6-28

### Added

- Ability to set generated modules fixtures to something other than the latest released version of `puppetlabs-pwshlib` on the Forge ([#93](https://github.com/puppetlabs/Puppet.Dsc/issues/93))
- A check to `New-PuppetDscModule` which validates that PSRemoting is enabled and errors clearly if not in order to prevent unexpected execution failures later in the process ([#133](https://github.com/puppetlabs/Puppet.Dsc/issues/133))
- Long file path support information to the requirements section of autogenerated READMEs ([#149](https://github.com/puppetlabs/Puppet.Dsc/issues/149))
- Notes on installation limitations to generated README files to clarify minitar limitations for `r10k` and serverless Puppet users ([#150](https://github.com/puppetlabs/Puppet.Dsc/issues/150))
- Clarification added regarding configuring the DSC Local Configuration Manager to work with Puppetized DSC modules (LCM) ([#139](https://github.com/puppetlabs/Puppet.Dsc/issues/139))
- Add `validation_mode` to allow choosing to rely on Puppet's property-by-property change reporting/insync testing or DSC's resource-level insync testing for cases where the DSC Resource does not correctly return current state as expected by its API surface. ([#145](https://github.com/puppetlabs/Puppet.Dsc/issues/145))

### Fixed

- Ensure that the auto-generated readme of a Puppetized module contains both the PowerShell and Puppet module names ([#153](https://github.com/puppetlabs/Puppet.Dsc/issues/153))
- Make all `Update-PuppetModuleReadme` parameters except `PuppetModuleName` mandatory and do not accept null or empty values ([#153](https://github.com/puppetlabs/Puppet.Dsc/issues/153))
- Make the `PowerShellModuleName` and `PuppetModuleName` parameters in `Get-Readmecontent` mandatory and do not accept null or empty values for any parameters ([#153](https://github.com/puppetlabs/Puppet.Dsc/issues/153))

## [0.5.0] - 2021-2-10

### Added

- `KeyUsage` and `OID` to the list of DSC Resource properties which should be treated as parameters in Puppet ([#111](https://github.com/puppetlabs/Puppet.Dsc/pull/111))
- Logic for vendoring dependency modules which are not found in the specified PowerShell module repository but _are_ available on the machine the module is being Puppetized on ([#113](https://github.com/puppetlabs/Puppet.Dsc/issues/113))
- Entries for PSCredential and CIM instance examples to generated READMEs ([#114](https://github.com/puppetlabs/Puppet.Dsc/issues/114))

### Fixed

- Ensure metadata summary is correctly parsed and defined ([#123](https://github.com/puppetlabs/Puppet.Dsc/issues/123))

## [0.4.0] - 2021-01-27

### Added

- Explicit dependency on PowerShellGet `2.2.3+` ([#124](https://github.com/puppetlabs/Puppet.Dsc/pull/124))

### Changed

- Vendored modules now namespaced by Puppet module to prevent side-by-side conflicts ([#75](https://github.com/puppetlabs/Puppet.Dsc/pull/75))
- Updated minimum supported version of the [`pwshlib`](https://forge.puppet.com/puppetlabs/pwshlib) module to [`0.7.0`](https://forge.puppet.com/modules/puppetlabs/pwshlib/changelog#070-2021-01-20) to ensure changes from [#75](https://github.com/puppetlabs/Puppet.Dsc/pull/75) work in the provider.

## [0.3.0] - 2020-12-14

### Added

- `JoinOU` to the static list of DSC Resource properties which are Puppet parameters ([#107](https://github.com/puppetlabs/Puppet.Dsc/pulls/107))

## Fixed

- Ensure changelog is actually updated during module Puppetization ([#108](https://github.com/puppetlabs/Puppet.Dsc/pull/))

## [0.2.0] - 2020-12-04

### Added

- Known limitations section to generated README ([#56](https://github.com/puppetlabs/Puppet.Dsc/pull/56))
- Function to update Puppet module changelog ([#57](https://github.com/puppetlabs/Puppet.Dsc/pull/57))
- Ability to Puppetize PowerShell modules marked as prerelease on the Gallery ([#76](https://github.com/puppetlabs/Puppet.Dsc/pull/76))
- Handling for non-retrievable DSC Resource properties as Puppet parameters ([#88](https://github.com/puppetlabs/Puppet.Dsc/pull/88))
- Clarification to generated README for properties passed to `Invoke-DscResource` and properties that set Puppet behavior ([#84](https://github.com/puppetlabs/Puppet.Dsc/pull/84))
- Handling for read-only properties, allowing them to be included in the generated types and appropriately marked ([#99](https://github.com/puppetlabs/Puppet.Dsc/pull/99))

### Changed

- Lower bound for `pwshlib-puppetlabs` raised to `0.6.1` ([#55](https://github.com/puppetlabs/Puppet.Dsc/pull/55))
- Upper bound for Puppet raised to `8.0.0` ([#101](https://github.com/puppetlabs/Puppet.Dsc/pull/101))
- Collapsed the `ensure` and `dsc_ensure` keywords into just `dsc_ensure` and _only_ for ensurable resources ([#88](https://github.com/puppetlabs/Puppet.Dsc/pull/88))

### Fixed

- Correct links in README ([#54](https://github.com/puppetlabs/Puppet.Dsc/pull/54))
- Parseability of generated description strings in type files ([#77](https://github.com/puppetlabs/Puppet.Dsc/pull/77),[#83](https://github.com/puppetlabs/Puppet.Dsc/pull/83))
- Type generation for DSC Resource properties which are nested CIM instances with optional keys ([#78](https://github.com/puppetlabs/Puppet.Dsc/pull/78))
- Always downcase keys in structs for embedded CIM instances to prevent type definition errors ([#98](https://github.com/puppetlabs/Puppet.Dsc/pull/98))
- Bug in generated README that hid text in the troubleshooting section ([#91](https://github.com/puppetlabs/Puppet.Dsc/pull/91))

## [0.1.0] - 2020-09-25

### Added

- Initial implementation and release

[unreleased]: https://github.com/puppetlabs/Puppet.Dsc/compare/1.0.0...main
[1.0.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/1.0.0
[0.7.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.7.0
[0.6.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.6.0
[0.5.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.5.0
[0.4.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.4.0
[0.3.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.3.0
[0.2.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.2.0
[0.1.0]: https://github.com/puppetlabs/Puppet.Dsc/releases/tag/0.1.0
